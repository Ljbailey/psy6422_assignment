---
Title: " Cultural Orientaion, Well-Being Outcomes and Wealth"
output: html_document
---

# Do Some Cultures Neglect Social Determinants of Health and Well-Being? A Visualisation of Countries Cultural Orientation, Well-Being Outcomes and Wealth.

## Background and Research Question
<p>The COVID-19 pandemic has had an enormous impact on people’s health and well-being across the globe. Contraction of the COVID-19 virus can cause [long-term health consequences](https://www.nhs.uk/conditions/coronavirus-covid-19/long-term-effects-of-coronavirus-long-covid/) and has globally [increased morality rates]( https://ourworldindata.org/excess-mortality-covid). Societies have been challenged to adapt and take preventative measures to mitigate COVID-19 infections and COVID-19 related deaths. The World Health Organisation's [COVID-19 guidelines](https://www.who.int/emergencies/diseases/novel-coronavirus-2019/advice-for-public) outlines the preventive measures which primarily includes wearing masks, washing hands, isolating and social distancing. The changes in the structure of living such as reduced physical contact and the fear surrounding contracting COVID-19 has also had repercussions on people’s [mental health](https://www.who.int/teams/mental-health-and-substance-use/covid-19).</p>
<p>One would think that wealthier countries would have lower COVID-19 cases and death rates as they have more resources for COVID-19 prevention.  On the contrary, deaths ascribed to COVID-19 are [higher in wealthier countries](https://www.brookings.edu/blog/future-development/2020/05/05/the-unreal-dichotomy-in-covid-19-mortality-between-high-income-and-developing-countries/). This begs the question *what factors are involved in the increase of COVID-19 related death in wealthier countries?* Are wealthier societies more susceptible to COVID-19 deaths because they have a higher vulnerable population such as [older age](https://www.economist.com/graphic-detail/2020/11/16/why-rich-countries-are-so-vulnerable-to-covid-19 ) and [obesity](https://www.bmj.com/content/372/bmj.n623#:~:text=The%20UK%20has%20the%20third,67.9%25%20of%20the%20population%20overweight.)? Or are wealthier societies unable to contain the spread of COVID-19 due to poor compliance to the World Health Organisation’s [COVID-19 guidelines](https://www.who.int/emergencies/diseases/novel-coronavirus-2019/advice-for-public)? More generally, *do differences in cultural attitudes, values and perceptions influence social determinants of health and well-being outcomes that are unrelated to wealth and resources?* </p>
<p>A cultural factor that could have an affect on the spread of COVID-19 is the degree to which the members of society perceive themselves as independent vs interdependent in the given society, this is known as the [individualism vs. collectivism continuum](https://www.hofstede-insights.com/country-comparison/). Individuals in individualist cultures primarily care for themselves and immediate family members and have a self-image of “I” whereas individuals in collectivist cultures care for their society as a whole and have a self-image of “we”. The perceptual differences between cultures may explain the inequality of COVID-19 deaths and other health and well-being outcomes. People in collectivist cultures may see themselves as having a broader impact on society thus abides by COVID-19 guidelines and ascribes higher importance to social responsibilities. In contrast, people in individualist cultures may be less likely to follow COVID-19 guidelines and disregard social responsibilities because of their individual interests. Within individualist cultures, [self-reported non-compliance](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0246941) of public health measures often surrounds behaviours that are inconvenient or not beneficial for them such as using contract tracing applications and willingness to take vaccinations.</p>
<p>This project attempts to initiate discussions and research into cultural factors associated with health outcomes as cross-cultural norms and values can provide insight into favourable attitudes underpinning societal health and well-being and can inform behavioural change interventions. The association of the following country variables will be examined and visualised to understand the broader cultural influence on health: **individualism index**, **GDP per capita**, **life expectancy**, **COVID-19 rates and deaths**, **happiness** and **suicide rates**.</p>  

![](pic.jpg)

## Data Origin 
<p>Data was extracted from multiple datasets listed on [Kaggle](https://www.kaggle.com/datasets). The countries [cultural dimensions dataset](https://www.kaggle.com/tarukofusuki/hofstedes-6d-model-of-national-culture) stems from [Hofstede's theory](https://www.hofstede-insights.com/country-comparison/) and data from 2015. The **individualism index** that reflects countries relative position on the collectivist - individualist continuum was extracted. Higher scores represent individualist cultural values whereas lower scores represents collectivist cultural values. Countries **GDP per Capita ($)** was extracted from a dataset consisting of countries [socioeconomic profiles](https://www.kaggle.com/nishanthsalian/socioeconomic-country-profiles) as of 2017. A dataset containing [World Health Organisation's data](https://www.kaggle.com/mmattson/who-national-life-expectancy) from 2016 was used to extract countries **life expectancy**. An up-to-date [COVID-19 Dataset](https://www.kaggle.com/josephassaker/covid19-global-dataset?select=worldometer_coronavirus_summary_data.csv) using [Woldometer's](https://www.worldometers.info/coronavirus/) statistics provided the  **countries total COVID-19 cases and deaths per 1 million population** data. This dataset was retrieved on 2021/05/11. The data from the [2020 World Happiness Report](https://www.kaggle.com/mathurinache/world-happiness-report) was used to extract the **happiness score**. The countries happiness is the average national score on the Cantril Ladder. The [Cantril Ladder](https://news.gallup.com/poll/122453/understanding-gallup-uses-cantril-scale.aspx) consists of people imagining their life in the best and worst way and to rate their present self on a scale from 0-10. **Countries suicide rates of the sexes per 100000 population**  from 2016 was extracted from a [mental health and suicide dataset](https://www.kaggle.com/twinkle0705/mental-health-and-suicide-rates).</p>
<p>The individual plots are displayed throughout this report to accompany brief summaries and break up chunks of code. The final interactive visualisation can be viewed under the heading *shiny application*. This application will allow the exploration of the data including the countries that the data points represent </p>

## Data Preperation
### Loading In The Data
```{r loading packages, warning = FALSE, echo = FALSE, results= 'hide', message=FALSE}
library(tidyverse)
library(here)
library(countrycode)
library(data.table)
library(shiny)
library(ggplot2)
library(htmlwidgets)
library(rsconnect)
library(shinyjs)
library(shinydashboard)
library(gtable)
```

```{r load in data, warning = FALSE}
# Loading in the different datasets

dim <- read.csv(here("data", "six_dimensions.csv"))

ses <- read.csv(here("data", "soci_econ_country_profiles.csv"))

life <- read.csv(here("data", "who_life_exp.csv"))

covid <- read.csv(here("data", "worldometer_coronavirus_summary_data.csv"))

happy <- read.csv(here("data", "world_happiness_report.csv"))

suicide <- read.csv(here("data", "suicide_rate.csv"))

```

### Data Wrangling
#### Modifying Datasets
```{r modifying datasets, warning = FALSE}
# Parse out cultural dimensions data
dim <- dim %>%
         separate(ctr.country.pdi.idv.mas.uai.ltowvs.ivr, 
             c("ctr", "country", "pdi", "idv", "mas", "uai", "lto", "ivr"),
            sep = ";")

dim$idv <- as.numeric(dim$idv)# Changes individualism class to numeric

# Selecting required data from each dataset

dim <- dim %>%
         select(country, idv)


ses <- ses %>%
         select(country,GDP.per.capita..current.US..)

life <- subset(life, year=="2016") # Remove rows not including year 2016

life <- life %>%
         select(country, life_expect)

covid <- covid %>%
         select(country, total_cases_per_1m_population, total_deaths_per_1m_population)


happy <- happy %>%
         select(Country.or.region, Score)


suicide <- suicide %>%
           select(Country, Sex, X2016)


# Re-naming columns of each dataset

colnames(dim)[2] <- "individualism"

colnames(ses)[2] <- "gdp_per_capita"

colnames(life)[1] <- "country"
colnames(life)[2] <- "life_expectancy"

colnames(covid)[2] <- "total_cases"
colnames(covid)[3] <- "total_deaths"

colnames(happy)[1] <- "country"
colnames(happy)[2] <- "happiness_score"

colnames(suicide)[1] <- "country"
colnames(suicide)[2] <- "sex"
colnames(suicide)[3] <- "suicide_rate"

```
#### Merging Datasets

```{r merging datasets, warning = FALSE}
#Converting country name to country codes

convert_code <-  function(x) {
      #converts country name to country codes
        countrycode(x, origin = "country.name", destination = "cowc")
}

dim$country <- convert_code(dim$country)

ses$country <- convert_code(ses$country)

life$country <- convert_code(life$country)

covid$country <- convert_code(covid$country)

happy$country <- convert_code(happy$country)

suicide$country <- convert_code(suicide$country)


# Adjoin data-frames with country codes

df <- inner_join(dim, ses, "country")

df <- inner_join(df, life, "country")

df<- inner_join(df, covid, "country")

df <- inner_join(df, happy, "country")

df <- inner_join(df, suicide, "country")

# Converting country code back to country names

df$country <- countrycode(df$country, origin = "cowc", destination = "country.name")

```
#### Data Cleaning
```{r data cleaning, warning = FALSE}

#Remove duplicated countries

df<- df%>% distinct(country,
                    sex,
                    .keep_all = TRUE) # Keep duplicated countries according to sex


# Delete country missing data

df <- df %>%
  na.omit(country)

```

### Preview Of The Data
```{r preview, warning = FALSE}

summary(df)

head(df)

```

## Data visualisations
### Pre-defining Aesthetics
```{r aesthetics, warning = FALSE, results= 'hide'}

# Pre-defined aesthetics

theme <- theme_light(base_size = 15) + # theme type and size
              theme(legend.background = element_rect(fill = "transparent"), 
                    plot.caption = element_text(hjust = 0), # position of writing
                    plot.title = element_text(hjust = 0.5))

line_alpha <- 0.1  # transparency of line standard error

point_alpha <- 0.2 # transparency of points

individualism_xscale <- scale_x_continuous(name="Individualism Index", 
                                          breaks= seq(0, 100, 10)) 

suicide_yscale <-  scale_y_continuous(name="Suicide Rate
(per 100000 Population)",
                                     breaks= seq(0, 50, 5))

individualism_gradient <- scale_colour_gradient(low = "blue", 
                                               high = "orange")

gdp_gradient <- scale_colour_gradient2(low = "magenta2",
                                      mid = "yellow2",
                                      high = "springgreen2",
                                      midpoint = 17675, #specify midpoint colour as median GDP per Capita
                                      breaks = seq(20000, 80000, by = 20000))
                                      
gdp_size_scale <- scale_size_continuous(range = c(3, 15)) # size range of points
                                       
line_colour <- "firebrick2"

sex_colour_aes <- c("#5899DA", "#945ECF", "#19A979")

sizelegend_adj <- guide_legend(reverse = TRUE, #change legend key order
                                  override.aes =list(linetype = c(0,0,0,0),
                                                     fill = NA)) # removes unwanted key aesthetics
                                  
legend_labels_adj <- guide_legend(title.position = "top",
                                  title.hjust = 0.5)
                       
```

### GDP per Capita Graph
```{r wealth, warning = FALSE, results= 'hide'}
# Country Wealth Plot
plot_wealth <- ggplot(df, aes (x = individualism, 
                               y = gdp_per_capita, 
                               shape = ifelse(individualism < 50, "Collectivistic Cultures", "Individualistic Cultures"), # specifying shape difference for scores above 50
                               color = individualism)) +
               ggtitle("Countries GDP per Capita and Cultural Orientation") +
               labs(color = "Individualism Index", 
                    shape = "Cultural Orientation") +
               individualism_xscale +
               scale_y_continuous(name="GDP per Capita ($)",
                                  breaks= seq(0, 80000, 10000)) +
               geom_point(size = 7, alpha = point_alpha) +
               geom_smooth((aes(shape=NA)),  # ignores shape variable creating one line
                            method = 'lm', 
                            color = "darkgreen", 
                            alpha = line_alpha) +
               individualism_gradient +
               theme +
               guides(colour = guide_colourbar(title.position = "top",
                                               title.hjust = 0.5,
                                               direction = "horizontal",
                                               boxheight = 1,
                                               barwidth = 15),
                      shape = guide_legend(title.position = "top",
                                           title.hjust = 0.5,
                                           override.aes = list(size = 5))) +
               theme(legend.direction  = "vertical",
                     legend.box = "horizontal",
                     legend.justification = c(0, 1),
                     legend.position = c(0, 1),
                     legend.title = element_text(size = 9), 
                     legend.text = element_text(size = 9))

```

```{r graph wealth, warning = FALSE, echo = FALSE, message = FALSE, fig.height = 10, fig.width = 15, fig.align = "center"}

print(plot_wealth)

```
As a countries GDP per Capita increases, countries individualism index increases. This demonstrates that individualist cultures tend to have more wealth than collectivist cultures. 

### Life Expectancy Graph
```{r life, warning = FALSE, results= 'hide'}

# Life Expectancy Plot
plot_life <- ggplot(df, aes(x = individualism, 
                            y = life_expectancy, 
                            size = gdp_per_capita,
                            color = gdp_per_capita)) +
            ggtitle("Countries Life Expectancy according to Cultural Orientation and GDP per Capita") +
            labs(color = "GDP per Capita ($)", 
                 size = "GDP per Capita ($)", 
                 caption = "*Life expectancy data is from 2016") +
            individualism_xscale +
            scale_y_continuous(name = "Life Expectancy 
(years)", 
                               breaks= seq(0, 100, 2)) +
            geom_point(alpha = point_alpha) +
            geom_smooth(method = 'lm',
                        color = line_colour, 
                        alpha = line_alpha) +
            gdp_gradient +
            gdp_size_scale +
            theme +
            guides(size = guide_legend(reverse = TRUE,
                                       override.aes =list(linetype = c(0,0,0,0),
                                                     size = c(5,4,3,2),
                                                     fill = NA)),
                   colour = guide_colourbar(title.position = "top",
                                            direction = "horizontal",
                                            title.hjust = 0.5,
                                            boxheight = 1,
                                            barwidth = 15)) +
            theme(legend.direction  = "vertical",
                     legend.box = "horizontal",
                     legend.justification = c(1, 0),
                     legend.position = c(1, 0),
                     legend.title = element_text(size = 9), 
                     legend.text = element_text(size = 9))
```


```{r graph life, warning = FALSE, echo = FALSE, message = FALSE, fig.height = 10, fig.width = 15, fig.align = "center"}
 
print(plot_life) 

```

As expected, individualist countries tend to have a higher life expectancy compared to collectivist countries which appears to be related to the countries wealth. Higher life expectancy in wealthier countries may stem from having more health resources. 

### COVID-19 Cases and Deaths Graph
```{r covid, warning = FALSE, results= 'hide'}
# COVID Plot
plot_covid <- ggplot(df, aes (x = individualism, 
                              y = total_cases, 
                              size = total_deaths,
                              color = gdp_per_capita)) +
              ggtitle("COVID-19 Cases and Deaths according to Countries Cultural Orientation and Wealth") +
              labs(color = "GDP per Capita ($)", 
                   size = "Total COVID-19 Deaths
(per 1 Million Population)", 
                   caption = "* COVID-19 data was retrieved on 11/05/2021") +
               individualism_xscale +
               scale_y_continuous(name="Total COVID-19 Cases
(per 1 Million Population)",
                                  breaks= seq(0, 155000, 20000)) + 
               geom_point(alpha = point_alpha) +
               geom_smooth(method = 'lm', 
                           color = line_colour, 
                           alpha = line_alpha) +
  
               scale_size_continuous(range = c(3, 18), 
                                     breaks = c(500, 1000, 1500, 2000)) +
               gdp_gradient +
               theme +
               guides(size = guide_legend(order = 2,  
                                          label.position = "right",
                                          title.position = "top",
                                          direction = "vertical",
                                          override.aes =list(linetype = c(0,0,0,0),
                                                             size = c(2,3,4,5),
                                                             fill = NA)),
                      colour = guide_colourbar(order = 1,
                                               title.position = "top",
                                               title.hjust = 0.5,
                                               boxheight = 1,
                                               barwidth = 15)) +
               theme(legend.direction  = "horizontal",
                     legend.box = "vertical",
                     legend.justification = c(0, 1),
                     legend.position = c(0, 1),
                     legend.title = element_text(size = 9), 
                     legend.text = element_text(size = 9))

```


```{r graph covid, warning = FALSE, echo = FALSE, message = FALSE, fig.height = 10, fig.width = 15, fig.align = "center"}

print(plot_covid)

```

The amount of COVID-19 contraction cases are associated with COVID-19 related deaths. Individualist countries tend to have higher COVID-19 cases compared to collectivist countries. Wealthier countries tend to have higher contraction rates of COVID-19. 

### Happiness Graph
```{r happy, warning = FALSE, results= 'hide'}          
                      
#Happiness plot

plot_happy <- ggplot(df, aes(x = individualism,
                             y = happiness_score,
                             size = gdp_per_capita, 
                             color = gdp_per_capita,
                             shape = ifelse(individualism < 50, "Collectivistic Cultures", "Individualistic Cultures"))) + 
              ggtitle(
"Countries Happiness in relation to Cultural Orientation and Wealth") + 
              labs(color = "GDP per Capita ($)", 
                   size = "GDP per Capita ($)", 
                   shape = "Cultural Orientation", 
                   caption = "* Happiness scores are produced from Cantril ladder scored reported in the World Happiness Report 2020") +
              individualism_xscale + 
              scale_y_continuous(name = "Happiness Score",
                                 breaks = seq(0, 10, 0.5))  +
              geom_point(alpha = point_alpha) + 
              geom_smooth((aes(colour = NA,
                               shape = NA)), 
                            color = line_colour, 
                            alpha = line_alpha) +
              gdp_size_scale +
              gdp_gradient +
              theme +
              guides(size = guide_legend(order = 2, 
                                         title.position = "top",
                                         label.position = "bottom",
                                         title.hjust = 0.5,
                                         override.aes =list(linetype = c(0,0,0,0),
                                                            fill = NA,
                                                            size = c(2,3,4,5))),
                     shape =  guide_legend(order = 1,
                                           direction = "vertical",
                                           title.position = "top",
                                           title.hjust = 0.5,
                                           override.aes = list(size = 5)),
                     colour = guide_colourbar(order =3,
                                              title.position = "top",
                                              title.hjust = 0.5,
                                              boxheight = 1,
                                              barwidth = 10)) +
               theme(legend.direction  = "horizontal",
                     legend.box = "horizontal",
                     legend.justification = c(1, 0),
                     legend.position = c(1, 0),
                     legend.title = element_text(size = 9), 
                     legend.text = element_text(size = 9))
```


```{r graph happy, warning = FALSE, echo = FALSE, message = FALSE, fig.height = 10, fig.width = 15, fig.align = "center"}

print(plot_happy)

```

Happiness scores appears to increase in a step wise fashion with happiness scores increasing when countries are considered individualist cultures. This finding suggests that the method used to measure happiness may over fit individualist cultural ideals and perceptions of happiness. The Cantril Ladder requires individuals to imagine the best and worse possible life and rate themselves on a scale of 0-10.  However, people in collectivist cultures have a self-image of "we" opposed to individualist cultures self-image of "I". Therefore, this question is inherently bias and may not reflect peoples happiness with self in collectivist cultures but the goals of the group as a whole. Furthermore, the question is not reflective of subjective happiness as living in *the best possible life* does not necessarily equate to happiness. Best and worse possibilities are embedded in the context of the country thus the perception of potential avenues in life can influence the scores rather than happiness. For instance, individualist cultures could have restrictive perceptions of possibilities thus score higher and collectivist cultures could percieve more possibilities as a group thus score lower on average. 

### Suicide Rates Graph
```{r suicide, warning = FALSE, results= 'hide'}
# Suicide Rates 

plot_suicide <- ggplot(df, aes(x = individualism, 
                               y = suicide_rate,
                               size = gdp_per_capita, 
                               color = sex, 
                               shape = sex)) +
                ggtitle("Suicide Rates of the Sexes in regards to Countries Wealth and Cultural Orientation") +
                labs(shape = "Sex", 
                     color = "Sex", 
                     linetype = "Sex", 
                     size = "GDP per Capita ($)", 
                     caption = "* Suicide rates reported in 2016 and are standardised by age") +
                individualism_xscale + 
                suicide_yscale +
                geom_point(alpha = point_alpha) +
                geom_smooth(method = 'lm', 
                            alpha = line_alpha, 
                            aes(linetype = sex,
                                fill = sex)) +  
                gdp_size_scale +
                scale_linetype_manual(values = c("dashed", "solid", "solid")) + 
                scale_color_manual(values = sex_colour_aes) + # change line colour
                scale_fill_manual(values = sex_colour_aes)  + # change standard error colour
                theme +
                guides(size = guide_legend(title.position = "top",
                                           label.position = "bottom",
                                           title.hjust = 0.5,
                                           direction = "horizontal",
                                           override.aes =list(linetype = c(0,0,0,0),
                                                              fill = NA,
                                                              size = c(2,3,4,5))),   
                       shape =  guide_legend(title.position = "top",
                                             title.hjust = 0.5,
                                             override.aes = list(size = 5, 
                                                                 linetype = c(0,0,0),
                                                                 fill = NA)),
                       linetype = guide_legend(title.position = "top",
                                               title.hjust = 0.5), # make same as shape so legends merge
                       fill = FALSE) +
               theme(legend.direction  = "vertical",
                     legend.box = "horizontal",
                     legend.justification = c(1, 1),
                     legend.position = c(1, 1),
                     legend.title = element_text(size = 10), 
                     legend.text = element_text(size = 10))

```

```{r graph suicide, warning = FALSE, echo = FALSE, message = FALSE, fig.height = 10, fig.width = 15, fig.align = "center"}

print(plot_suicide)

```

As individualism increases, suicide rates increase. Male suicide rates increase more when individualism increases. Suicide rates tend to be lower in poorer countries.


### Happiness and Suicide Rates Graph
```{r happy suicide, warning = FALSE, results= 'hide'}   
#Happiness and suicide rates

plot_sui_happ <- ggplot(subset(df, sex == " Both sexes"), #subset data
                        aes(y = suicide_rate, 
                            x = happiness_score,
                            size = gdp_per_capita,
                            color = individualism,
                            shape = ifelse(individualism < 50, "Collectivistic Cultures", "Individualistic Cultures"))) + 
                ggtitle("Suicide Rates according to Countries Happiness, Wealth and Cultural Orientation") +
                labs(shape = "Cultural Orientation",
                     color = "Individualism Index", 
                     size = "GDP per Capita ($)",
                     caption = "* Suicide rates are standardised by age and reported in 2016
** Happiness scores are produced from indicators in the World Happiness Report 2020") +
                scale_x_continuous(name="Happiness Score",
                                   breaks= seq(0, 10, 0.5)) +
                suicide_yscale +
                geom_point(alpha = point_alpha) +
                gdp_size_scale +
                individualism_gradient +
                theme +
                guides(shape = guide_legend(order = 2, 
                                            title.position = "top",
                                            title.hjust = 0.5, 
                                            override.aes = list(size = 5)),
                       colour = guide_colourbar(order = 1, 
                                                title.position = "top",
                                                title.hjust = 0.5,
                                                boxheight = 1,
                                                barwidth = 15),
                       size = guide_legend(order = 3,
                                           title.position = "top",
                                           label.position = "bottom",
                                           title.hjust = 0.5, 
                                           override.aes =list(linetype = c(0,0,0,0),
                                                              size = c(2,3,4,5),
                                                               fill = NA))) +
                theme(legend.direction  = "horizontal",
                      legend.box = "vertical",
                      legend.justification = c(0, 1),
                      legend.position = c(0, 1),
                      legend.title = element_text(size = 9), 
                      legend.text = element_text(size = 9))
```

```{r suicide happy plot, warning = FALSE, echo = FALSE, message = FALSE, fig.height = 10, fig.width = 15, fig.align = "center"}

print(plot_sui_happ)

```

There is no relationship between happiness scores and suicide rates. This indicates that the happiness score reflected by the Cantril Ladder is not representative of countries subjective happiness. 

### Shiny Application
``` {r shiny, warning = FALSE, fig.height = 10, fig.width = 15, fig.align = "center", echo = FALSE, results= 'hide'}


shinyApp(
# User interface
ui <- fluidPage(
    fluidRow(column(width = 5, 
                    titlePanel("Countries Cultural Orientation, Wealth, and Well-Being"),
                    selectInput("graph", "Choose variables", c("Wealth and Individualism",
                                        "Life Expectancy, Individualism and Wealth",
                                        "COVID-19 Cases and Death, Individualism and Wealth", 
                                        "Happiness, Individualism and Wealth",
                                        "Suicide Rates, Sex, Individualism and Wealth",
                                        "Suicide Rates, Happiness, Individualism and Wealth")))),

fluidRow(
#Each drop down box option and conditional specified output
  column(width = 12,
         conditionalPanel('input.graph=="Wealth and Individualism"',
                          plotOutput("wealth", 
                                     hover = hoverOpts(id ="hover_wealth",
                                                       delay = 100, 
                                                       delayType = "debounce")),
                          uiOutput("hover_wealth_info")
                          
                          )),
  column(width = 12,
         conditionalPanel('input.graph=="Life Expectancy, Individualism and Wealth"', plotOutput("life", 
                     hover = hoverOpts(id ="hover_life",
                                       delay = 100, 
                                       delayType = "debounce")),
                     uiOutput("hover_life_info")
                          )),
   column(width = 12,
         conditionalPanel('input.graph=="COVID-19 Cases and Death, Individualism and Wealth"', plotOutput("covid",
                                       hover = hoverOpts(id ="hover_covid",
                                                         delay = 100, 
                                                        delayType = "debounce")),
                                       uiOutput("hover_covid_info")
                          )),
  column(width = 12,
         conditionalPanel('input.graph=="Happiness, Individualism and Wealth"', plotOutput("happy",
                     hover = hoverOpts(id ="hover_happy",
                                       delay = 100, 
                                       delayType = "debounce")),
                     uiOutput("hover_happy_info")
                         )),
  column(width = 12,
         conditionalPanel('input.graph=="Suicide Rates, Sex, Individualism and Wealth"', plotOutput("suicide",
                         hover = hoverOpts(id ="hover_suicide",
                                           delay = 100, 
                                           delayType = "debounce")),
                         uiOutput("hover_suicide_info")
                          
                          )),
  column(width = 12,
         conditionalPanel('input.graph=="Suicide Rates, Happiness, Individualism and Wealth"', plotOutput("sui_happ",
                                        hover = hoverOpts(id ="hover_sui_happ",
                                                          delay = 100,
                                                          delayType = "debounce")),
                         uiOutput("hover_sui_happ_info")
                          
                          ))
  ), 

),
# Functionality

server <- function(input, output, session){ 

#plot and hover output  specified for each drop down box and graph
      
    output$wealth <- renderPlot({
        validate(need(input$graph=="Wealth and Individualism", message=FALSE))
        plot_wealth
    })

  output$hover_wealth_info <- renderUI({
    hover_wealth <- input$hover_wealth
    point_wealth <- nearPoints(df, hover_wealth, xvar = "individualism", yvar = "gdp_per_capita", threshold = 5, maxpoints = 1, addDist = TRUE) 
    if (nrow(point_wealth) == 0) return(NULL)

# distance from left and bottom side
    left_px <- hover_wealth$coords_css$x
    top_px <- hover_wealth$coords_css$y

# background color set to transparent and z-index so tooltip is on top
    style <- paste0("position:absolute; z-index:100; background-color: rgba(245, 245, 245, 0.85); ",
                    "left:", left_px + 2, "px; top:", top_px + 2, "px;")
    
# creating tooltip
    wellPanel(
      style = style,
      p(HTML(paste0("<b> Country: </b>", point_wealth$country, "<br/>",
                    "<b> Individualism Index: </b>", point_wealth$individualism, "<br/>",
                    "<b> GDP per Capita ($): </b>", point_wealth$gdp_per_capita, "<br/>",
                    "<b> Distance from left: </b>", left_px, "<br/>",
                    "<b> Distance from top: </b>", top_px, "</br>"
                      )))
    )
  })

    output$life <- renderPlot({
        validate(need(input$graph=="Life Expectancy, Individualism and Wealth", message=FALSE))
        plot_life
    })
    
 output$hover_life_info <- renderUI({
    hover_life <- input$hover_life
    point_life <- nearPoints(df, hover_life, xvar = "individualism", yvar = "life_expectancy", threshold = 5, maxpoints = 1, addDist = TRUE) 
    if (nrow(point_life) == 0) return(NULL)
    
    left_px <- hover_life$coords_css$x
    top_px <- hover_life$coords_css$y

    style <- paste0("position:absolute; z-index:100; background-color: rgba(245, 245, 245, 0.85); ",
                    "left:", left_px + 2, "px; top:", top_px + 2, "px;")

    wellPanel(
      style = style,
      p(HTML(paste0("<b> Country: </b>", point_life$country, "<br/>",
                    "<b> Individualism Index: </b>", point_life$individualism, "<br/>",
                    "<b> Life Expectancy (years): </b>", point_life$life_expectancy, "<br/>",
                    "<b> GDP per Capita ($): </b>", point_life$gdp_per_capita, "<br/>",
                    "<b> Distance from left: </b>", left_px, "<br/>",
                    "<b> Distance from top: </b>", top_px, "</br>"
                      )))
    )
  })   
    
    output$covid <- renderPlot({
        validate(need(input$graph=="COVID-19 Cases and Death, Individualism and Wealth", message=FALSE))
        plot_covid
    }) 
    
   output$hover_covid_info <- renderUI({
    hover_covid <- input$hover_covid
    point_covid <- nearPoints(df, hover_covid, xvar = "individualism", yvar = "total_cases", threshold = 5, maxpoints = 1, addDist = TRUE) 
    if (nrow(point_covid) == 0) return(NULL)
    
    left_px <- hover_covid$coords_css$x
    top_px <- hover_covid$coords_css$y

    style <- paste0("position:absolute; z-index:100; background-color: rgba(245, 245, 245, 0.85); ",
                    "left:", left_px + 2, "px; top:", top_px + 2, "px;")
   
    wellPanel(
      style = style,
      p(HTML(paste0("<b> Country: </b>", point_covid$country, "<br/>",
                    "<b> Individualism Index: </b>", point_covid$individualism, "<br/>",
                    "<b> COVID-19 cases (per 1 million population): </b>", point_covid$total_cases, "<br/>",
                    "<b> COVID-19 deaths (per 1 million population): </b>", point_covid$total_deaths, "<br/>",
                    "<b> GDP per Capita ($): </b>",  point_covid$gdp_per_capita, "<br/>",
                    "<b> Distance from left: </b>", left_px, "<br/>",
                    "<b> Distance from top: </b>", top_px, "</br>"
                      )))
    )
  })   
    
     output$happy <- renderPlot({
        validate(need(input$graph=="Happiness, Individualism and Wealth", message=FALSE))
        plot_happy
    }) 
     
    output$hover_happy_info <- renderUI({
      hover_happy <- input$hover_happy
    point_happy <- nearPoints(df, hover_happy, xvar = "individualism", yvar = "happiness_score", threshold = 5, maxpoints = 1, addDist = TRUE) 
    if (nrow(point_happy) == 0) return(NULL)
    
    left_px <- hover_happy$coords_css$x
    top_px <- hover_happy$coords_css$y

    style <- paste0("position:absolute; z-index:100; background-color: rgba(245, 245, 245, 0.85); ",
                    "left:", left_px + 2, "px; top:", top_px + 2, "px;")
    
    wellPanel(
      style = style,
      p(HTML(paste0("<b> Country: </b>", point_happy$country, "<br/>",
                    "<b> Individualism Index: </b>", point_happy$individualism, "<br/>",
                    "<b> Happiness Score: </b>", point_happy$happiness_score, "<br/>",
                    "<b> GDP per Capita ($): </b>",  point_happy$gdp_per_capita, "<br/>",
                    "<b> Distance from left: </b>", left_px, "<br/>",
                    "<b> Distance from top: </b>", top_px, "</br>"
                      )))
    )
  }) 
    
     output$suicide <- renderPlot({
        validate(need(input$graph=="Suicide Rates, Sex, Individualism and Wealth", message=FALSE))
        plot_suicide
    }) 
     
      output$hover_suicide_info <- renderUI({
    hover_suicide <- input$hover_suicide
    point_suicide <- nearPoints(df, hover_suicide, xvar = "individualism", yvar = "suicide_rate", threshold = 5, maxpoints = 1, addDist = TRUE) 
    if (nrow(point_suicide) == 0) return(NULL)
    
    left_px <- hover_suicide$coords_css$x
    top_px <- hover_suicide$coords_css$y

    style <- paste0("position:absolute; z-index:100; background-color: rgba(245, 245, 245, 0.85); ",
                    "left:", left_px + 2, "px; top:", top_px + 2, "px;")
    
    wellPanel(
      style = style,
      p(HTML(paste0("<b> Country: </b>", point_suicide$country, "<br/>",
                    "<b> Individualism Index: </b>", point_suicide$individualism, "<br/>",
                    "<b> Suicide Rate (per 100000 population): </b>", point_suicide$suicide_rate, "<br/>",
                    "<b> GDP per Capita ($): </b>", point_suicide$gdp_per_capita, "<br/>",
                    "<b> Sex: </b>", point_suicide$sex, "<br/>",
                    "<b> Distance from left: </b>", left_px, "<br/>",
                    "<b> Distance from top: </b>", top_px, "</br>"
                      )))
    )
  })  
     
      output$sui_happ <- renderPlot({
        validate(need(input$graph=="Suicide Rates, Happiness, Individualism and Wealth", message=FALSE))
        plot_sui_happ
    }) 
      
       output$hover_sui_happ_info <- renderUI({
    hover_sui_happ <- input$hover_sui_happ
    point_sui_happ <- nearPoints(df, hover_sui_happ, xvar = "happiness_score", yvar = "suicide_rate", threshold = 5, maxpoints = 1, addDist = TRUE) 
    if (nrow(point_sui_happ) == 0) return(NULL)
    
    left_px <- hover_sui_happ$coords_css$x
    top_px <- hover_sui_happ$coords_css$y

    style <- paste0("position:absolute; z-index:100; background-color: rgba(245, 245, 245, 0.85); ",
                    "left:", left_px + 2, "px; top:", top_px + 2, "px;")
   
    wellPanel(
      style = style,
      p(HTML(paste0("<b> Country: </b>", point_sui_happ$country, "<br/>",
                    "<b> Happiness Score: </b>", point_sui_happ$happiness_score, "<br/>",
                    "<b> Suicide Rate (per 100000 population): </b>", point_sui_happ$suicide_rate, "<br/>",
                    "<b> Individualism Index: </b>", point_sui_happ$individualism, "<br/>",
                    "<b> GDP per Capita ($): </b>", point_sui_happ$gdp_per_capita, "<br/>",
                    "<b> Distance from left: </b>", left_px, "<br/>",
                    "<b> Distance from top: </b>", top_px, "</br>"
                      )))
    )
  })  
     
},
  options = list(height = 700)

)

```


<iframe src ="https://psyassessment.shinyapps.io/psy6422_assignment/"
  scrolling = "no" style="border: none; overflow:hidden; width: 100%; height: 700px;"/>
</iframe>

You can hover over the data points to see which countries they represent and the relevant information. If the shiny application does not load or is not working properly, you can visit the application directly [here](https://psyassessment.shinyapps.io/psy6422_assignment/). You can also visit my [github repository](https://github.com/Ljbailey/psy6422_assignment) to have access to all of the data, the Rmd file and scripts so you can run it locally or even do some further data exploration! 


## Summary
Overall this visualisation demonstrates that some aspects of peoples health and well-being do not solely rely on countries economic prosperity. Cultural norms, attitudes and perceptions common in wealthy countries, such as individualism, may have a negative impact on social determinants of health and well-being. Indeed, countries individualism index is related to wealth and these were associated with higher life expectancy. This relationship can be attributed to an increase in health resources, however, this data does not give any indication of social determinants of health or peoples quality of life. Exploring COVID-19 data revealed that individualistic countries have higher COVID-19 contraction rates suggesting that individualist values may indicate poor compliance to World Health Organisation's [COVID-19 guidelines](https://www.who.int/emergencies/diseases/novel-coronavirus-2019/advice-for-public). Accordingly, individualist cultural values may hinder peoples sense of social responsibility that can in turn have detrimental affects on the health and well-being of people within the country. Countries happiness scores did relate to individualist countries however, happiness scores only increased in individualistic countries. This pattern in the data indicates that the happiness measurement tool is bias and over fits individualist ideals of happiness. This interpretation is substantiated with higher suicide rates, particularly for men, in individualist cultures that did not relate to happiness scores. Further data exploration and research is warranted to systematically investigate cultural factors influence on health and well-being.   


## Caveats and Future Directions

Non-random missing data in these datasets could have biased the outcome of the visualisations. For instance, COVID-19 cases and deaths and suicide rates could be systematically under reported in poorer countries due to fewer resources. However, the relationship between these reports in wealthier countries is variable suggesting that the fluctuations in reports are not necessarily tied to resources and that missing data would not change the direction of the relationship. The age of some data used in this project is not up-to-date. Limited contemporary data was available that was sufficient to answer the proposed research question. Further research should focus on collecting data for further exploration to determine if these trends still remain. It is important to note that the relationship between variables in this visualisation are associative. The aim of this project was not to test causal relationships but to explore and visualise relationships as a means to uncover trends.The exploration and visualisation of associations between countries cultural orientation and well-being outcomes hopefully provides a mean and motivation for properly designed experiments to test these hypotheses. In light of the relationship between individualism and the happiness score, [Gallup's research intiatives](https://news.gallup.com/poll/122453/understanding-gallup-uses-cantril-scale.aspx) and the [World Happiness Report](https://worldhappiness.report/) may wish to re-evaluate the psychometric properties of the Cantril ladder including its generalisability to different cultures and its validity in measuring and representing happiness.   
